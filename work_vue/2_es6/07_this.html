<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    function Person(name, age) {
      this.name = name;
      this.age = age;
      console.log(`Person(name, age) : ${this}, ${this.age}`);
    }

    let p1 = new Person("김재환", 27); //new해서 객체를 만들었기 때문에 this는 객체자체이다. 
    Person("박보검", 30); //this는 window!! window의 age에 받아온 나이를 집어넣음. 동적 속성(새로운 속성으로 추가 됨).
    console.log(window.age); //window에 집어놓은 거기 때문에 30 출력




    ////////////////



    function hello() { //선언적 방법
      console.log(`hello: ${this}`);
    }

    //goodbye는 arrow function으로 전역으로 불러도 윈도우 
    const goodbye = () => console.log(`goodbye: ${this}`); //arrow function 여기엔 this가 없다.
    //하지만 error는 없다 왜 ?

    let greeting = {
      hello, //short property
      goodbye
    }
    hello(); //얘는 this가 없음
    //greeting.hello(); 얘는 this가 있음

    //어떻게 실행되느냐(어떻게, 어디서 호출되느냐)에 따라 this가 달라짐
    // hello(); //this : Window. hello()는 Global하게 선언된 함수이기 때문에.
    // greeting.hello(); //this : Object. greeting 객체의 메소드로서 호출된 함수이기 때문에 호출한 객체 자체가 this이다.

    // greeting.goodbye();

    //arror 펑션이 아닌애들은 다 this 가 잇따 
    //this에 대응되어지는 
    hello.call(window);
    //이게 있으면 이놈이 this가 된다.
    hello.call({ "name": "kjh", age: 20 })
    hello.call({ "name": "ssafy", age: 4 })

    // function a() {
    //   let aa = 10;
    //   function b() { //객체로 부르지 않는 이상 얘의 this는 window이다
    //     let bb = 20;
    //     console.log(aa, bb, this);
    //   }
    //   b();
    //   return b;
    // }
    // a();

    function a() {
      let aa = 10;
      b = () => { //얘는 arrow라 this가 없다..!! 상위 스콮으로 가서 this찾아 function a()로..
        //근데 function a()의 this는?? 밖에서 a();가 있네???
        //function a()의 this는 window이다 밖에서 호출되고잇으니까
        let bb = 20;
        console.log(aa, bb, this);
      }
      b();
      return b;
    }
    a();


    //중요!!!!!!!!!!!!!!!!!!!!! arror function은 this가 없다!!!!!!!!!!!!!!!
    //참고: 이벤트핸들러 콜백의 this는 자기 자신이다.
  </script>
</body>

</html>